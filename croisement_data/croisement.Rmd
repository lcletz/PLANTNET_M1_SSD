---
title: "Croisement"
author: "AIGOIN Emilie"
date: "2025-03-10"
output: html_document
---

Croiser les données de samples et de tasks

```{r}

# Charger les bibliothèques nécessaires
library(jsonlite)

# Charger les fichiers JSON
resultat_enrichi <- fromJSON("/Users/emilieaigoin/Desktop/multiple_data/resultat_enrichi.json")
sample_tasks_answers_merged <- fromJSON("/Users/emilieaigoin/Desktop/multiple_data/sample_tasks_answers_merged.json")

# Fonction pour comparer les identifiants
add_correct_column <- function(resultat_enrichi, sample_tasks_answers_merged) {
  for (key in names(resultat_enrichi)) {
    for (i in 1:length(resultat_enrichi[[key]])) {
      second_id <- resultat_enrichi[[key]][[i]]$second_id
      # Vérifier si le second_id est dans sample_tasks_answers_merged
      if (as.character(second_id) %in% names(sample_tasks_answers_merged)) {
        answer_value <- sample_tasks_answers_merged[[as.character(second_id)]]$answer_value
        # Comparer les second_id et answer_value
        if (second_id == answer_value) {
          resultat_enrichi[[key]][[i]]$correct <- 1
        } else {
          resultat_enrichi[[key]][[i]]$correct <- 0
        }
      } else {
        resultat_enrichi[[key]][[i]]$correct <- 0
      }
    }
  }
  return(resultat_enrichi)
}

# Appliquer la fonction pour ajouter la colonne 'correct'
resultat_enrichi <- add_correct_column(resultat_enrichi, sample_tasks_answers_merged)

# Sauvegarder le fichier modifié
write_json(resultat_enrichi, "/Users/emilieaigoin/Desktop/multiple_data/resultat_enrichi_with_correct.json", pretty = TRUE)


```

